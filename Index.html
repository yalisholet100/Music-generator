<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Suno Track Generator</title>
</head>
<body>
  <h1>יצירת שיר ב-Suno</h1>
  <button id="generateBtn">צור שיר</button>
  <p id="status">לחץ על הכפתור כדי להתחיל</p>
  <a id="trackLink" href="#" target="_blank" style="display:none;">להאזנה לשיר</a>

  <script>
    const TOKEN = "6fb515a03929b751c8d50971a17c09f1";

    async function generateTrack() {
      document.getElementById("status").innerText = "שולח בקשה ליצירת שיר...";
      const res = await fetch("https://studio-api.suno.ai/api/generate/v2/", {
        method: "POST",
        headers: {
          "Authorization": "Bearer " + TOKEN,
          "Content-Type": "application/json"
        },
        body: JSON.stringify({
          title: "Godzilla Drop",
          prompt: "epic dark trance inspired by Godzilla in Tel Aviv, demonic voice, 142 bpm, intense energy",
          tags: ["electronic", "trance", "dark"],
          gpt_description_prompt: "",
          mv: "chirp-v3-0",
          num_results: 1
        })
      });

      const data = await res.json();
      return data.clips[0].id;
    }

    async function waitForTrack(taskId) {
      document.getElementById("status").innerText = "ממתין שהשיר יושלם...";

      while (true) {
        const res = await fetch(`https://studio-api.suno.ai/api/feed/?ids=${taskId}`, {
          headers: {
            "Authorization": "Bearer " + TOKEN
          }
        });

        const data = await res.json();
        const clip = data.clips[0];

        if (clip && clip.status === "complete") {
          document.getElementById("status").innerText = "הטראק מוכן!";
          const link = document.getElementById("trackLink");
          link.href = clip.audio_url;
          link.innerText = "לחץ כאן להאזנה";
          link.style.display = "inline";
          return;
        }

        await new Promise(r => setTimeout(r, 5000));
      }
    }

    document.getElementById("generateBtn").addEventListener("click", async () => {
      const taskId = await generateTrack();
      await waitForTrack(taskId);
    });
  </script>
</body>
</html>
